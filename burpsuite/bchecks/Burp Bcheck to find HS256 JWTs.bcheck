metadata:
    language: v1-beta
    name: "HS256 JWT Detection"
    description: "JWT Using HS256"
    tags: "passive"
    author: "@ldionmarcil"

given response then
    if {latest.response} matches "ey[\w]+((oc|IU)zI1N|(aH|SF)MyNT|(hz|hT)MjU)[\w\-=]*\." then
        report issue:
            severity: high
            confidence: firm
            detail: "Found a JWT using HS256"
            remediation: "Attempt to bruteforce the key used to sign this JWT."
    end if
